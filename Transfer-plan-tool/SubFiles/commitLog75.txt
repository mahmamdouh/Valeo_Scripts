b'commit 0bd1a9a1be84ec8d50613b42192622d464ef9892
Author: Yunpeng DONG (JV) <yunpeng.dong.jv@valeo.com>
Date:   Thu Jan 13 17:51:34 2022 +0800

    $100kW-50155$ - FCT_DchaSysSw - Release Unit construction
    
    Change-Id: Iad9cc65e4329bbbc1c7e85480ec70f79d8e72f63

diff --git a/src/fw_cu/Components/Safety/Sfty_Inv/SftyActvDchaCtrl/include/SftyActvDchaCtrl_data.h b/src/fw_cu/Components/Safety/Sfty_Inv/SftyActvDchaCtrl/include/SftyActvDchaCtrl_data.h
index 2d259badf..6785a4e42 100644
--- a/src/fw_cu/Components/Safety/Sfty_Inv/SftyActvDchaCtrl/include/SftyActvDchaCtrl_data.h
+++ b/src/fw_cu/Components/Safety/Sfty_Inv/SftyActvDchaCtrl/include/SftyActvDchaCtrl_data.h
@@ -24,18 +24,7 @@
 #include "Platform_Types.h"
 #include "Compiler.h"
 
-#ifndef\t_online
-#define\t_online
-#endif
-#ifndef\t_param
-#define\t_param
-#endif
-#ifndef\t_axis
-#define\t_axis
-#endif
-#ifndef\t_map
-#define\t_map
-#endif
+
 
 
 /*================== [includes] =============================================*/
@@ -43,7 +32,7 @@
 #include\t"AddStructTypes.h"
 #include\t"AddEnumTypes.h"
 #include    "C2cComSftyData.h"
-#include    "Cmr.h"
+
 
 
 
@@ -87,6 +76,8 @@
 #define CNT_1S_TO_10MS            (100U)
 
 
+#define SFTY_ACTIV_DCHA_ENABLED    (1U)
+#define SFTY_ACTIV_DCHA_DISABLED   (0U)
 
   
 /*================== [Type Definitions] =====================================*/
diff --git a/src/fw_cu/Components/Safety/Sfty_Inv/SftyActvDchaCtrl/src/SftyActvDchaCtrl.c b/src/fw_cu/Components/Safety/Sfty_Inv/SftyActvDchaCtrl/src/SftyActvDchaCtrl.c
index 52ed79b83..353cb519b 100644
--- a/src/fw_cu/Components/Safety/Sfty_Inv/SftyActvDchaCtrl/src/SftyActvDchaCtrl.c
+++ b/src/fw_cu/Components/Safety/Sfty_Inv/SftyActvDchaCtrl/src/SftyActvDchaCtrl.c
@@ -128,7 +128,7 @@ STATIC VAR(uint8, SFTYACTVDCHACTRL_VAR) SftyActvDchaCtrlActvDchaReq = ACTV_DCHA_
 @@ GROUP = SftyActvDchaCtrl
 @@ END
 */
-STATIC VAR(uint8, SFTYACTVDCHACTRL_VAR) SftyActvDchaCtrlReqAdisByRCmdUpdEna = DISABLED;
+STATIC VAR(uint8, SFTYACTVDCHACTRL_VAR) SftyActvDchaCtrlReqAdisByRCmdUpdEna = SFTY_ACTIV_DCHA_DISABLED;
 
 
 /*
@@ -382,7 +382,7 @@ LOCAL_INLINE void SftyActvDchaCtrl_GetInputData(void)
 #endif /* SERIES_PRODUCTION */
    
    {
-      SftyActvDchaCtrlBattCntctrSts = HV_BATT_CONTACTOR_OPEN;   /* SftyE2ePhyDataVcuInvStat1BattContactorSt */;
+      SftyActvDchaCtrlBattCntctrSts = SftyE2ePhyDataVcuInvStat1BattContactorSt;  
 \t  SftyActvDchaCtrlE2eReq        = SftyE2ePhyDataVcuInvCtrl1ActDischReq;
    }
 
@@ -476,20 +476,20 @@ LOCAL_INLINE void SftyActvDchaCtrl_StrtupTest(void)
 LOCAL_INLINE void SftyActvDchaCtrl_IntelAdisReq(void)
 {
    /* ******** Variables declaration *********** */
-   uint8 SftyActvDchaCtrlActvDchaReqIntel_1 = ACTV_DCHA_DEACTVE;
-   uint8 SftyActvDchaCtrlActvDchaReqIntel_2 = ACTV_DCHA_DEACTVE;
-   uint8 SftyActvDchaCtrlActvDchaReqIntel_3 = ACTV_DCHA_DEACTVE;
+   uint8 sftyActvDchaCtrlActvDchaReqIntel_1;
+   uint8 sftyActvDchaCtrlActvDchaReqIntel_2;
+   uint8 sftyActvDchaCtrlActvDchaReqIntel_3;
    
    /* ************* Source code **************** */
 
    /* 1> Checking Condition 1 */
    if (SftyActvDchaCtrlFctIdActvDcha == ACTV_DCHA_ACTVE)
    {
-      SftyActvDchaCtrlActvDchaReqIntel_1 = ACTV_DCHA_ACTVE;
+      sftyActvDchaCtrlActvDchaReqIntel_1 = ACTV_DCHA_ACTVE;
    }
    else
    {
-      SftyActvDchaCtrlActvDchaReqIntel_1 = ACTV_DCHA_DEACTVE;
+      sftyActvDchaCtrlActvDchaReqIntel_1 = ACTV_DCHA_DEACTVE;
    }
 
    
@@ -498,11 +498,11 @@ LOCAL_INLINE void SftyActvDchaCtrl_IntelAdisReq(void)
    \t   &&
    \t   (SftyActvDchaCtrlFctIdCanVcuInvCtrl1 == ACTV_DCHA_ACTVE))
    {
-      SftyActvDchaCtrlActvDchaReqIntel_2 = ACTV_DCHA_ACTVE;
+      sftyActvDchaCtrlActvDchaReqIntel_2 = ACTV_DCHA_ACTVE;
    }
    else
    {
-      SftyActvDchaCtrlActvDchaReqIntel_2 = ACTV_DCHA_DEACTVE;
+      sftyActvDchaCtrlActvDchaReqIntel_2 = ACTV_DCHA_DEACTVE;
    }
 
 
@@ -510,20 +510,20 @@ LOCAL_INLINE void SftyActvDchaCtrl_IntelAdisReq(void)
    if (((SftyActvDchaCtrlHvDcUVal < SftyActvDchaPrmData.VbatMinThd) || (SftyActvDchaCtrlFctIdActvDchaCanFailr == ACTV_DCHA_ACTVE)) 
    \t   && (SftyActvDchaCtrlFctIdCanVcuInvCtrl1 == ACTV_DCHA_ACTVE))
    \t{
-   \t   SftyActvDchaCtrlActvDchaReqIntel_3 = ACTV_DCHA_ACTVE;
+   \t   sftyActvDchaCtrlActvDchaReqIntel_3 = ACTV_DCHA_ACTVE;
    \t}
 \telse
 \t{
-\t   SftyActvDchaCtrlActvDchaReqIntel_3 = ACTV_DCHA_DEACTVE;
+\t   sftyActvDchaCtrlActvDchaReqIntel_3 = ACTV_DCHA_DEACTVE;
 \t}
 
 
    /* 4> Checking Internal Adis Request */
-   if ((SftyActvDchaCtrlActvDchaReqIntel_1 == ACTV_DCHA_ACTVE)
+   if ((sftyActvDchaCtrlActvDchaReqIntel_1 == ACTV_DCHA_ACTVE)
    \t    ||
-   \t    (SftyActvDchaCtrlActvDchaReqIntel_2 == ACTV_DCHA_ACTVE)
+   \t    (sftyActvDchaCtrlActvDchaReqIntel_2 == ACTV_DCHA_ACTVE)
    \t    ||
-   \t    (SftyActvDchaCtrlActvDchaReqIntel_3 == ACTV_DCHA_ACTVE))
+   \t    (sftyActvDchaCtrlActvDchaReqIntel_3 == ACTV_DCHA_ACTVE))
    {
       SftyActvDchaCtrlActvDchaReqIntel = ACTV_DCHA_ACTVE;
    }
@@ -623,18 +623,18 @@ LOCAL_INLINE void SftyActvDchaCtrl_DetmnAdisReq(void)
 LOCAL_INLINE void SftyActvDchaCtrl_UpdAdisReqCmd(void)
 {
    /* ******** Variables declaration *********** */
-   uint32 SftyActvDchaCtrlAdisByRRtryDurnTim = 0UL;
+   uint32 sftyActvDchaCtrlAdisByRRtryDurnTim;
    
    /* ************* Source code **************** */
 
    /* Interval Time Checking between 2 Adjacent Request */
-   if (SftyActvDchaCtrlReqAdisByRCmdUpdEna == DISABLED)
+   if (SftyActvDchaCtrlReqAdisByRCmdUpdEna == SFTY_ACTIV_DCHA_DISABLED)
    {
-\t  SftyActvDchaCtrlAdisByRRtryDurnTim = ((uint32)SftyActvDchaPrmData.AdisByRRtryDurnTimThd) * ((uint32)CNT_1S_TO_1MS);
+\t  sftyActvDchaCtrlAdisByRRtryDurnTim = ((uint32)SftyActvDchaPrmData.AdisByRRtryDurnTimThd) * ((uint32)CNT_1S_TO_1MS);
 \t  
-      if (SftyActvDchaCtrlByRRtryDurnCnt > SftyActvDchaCtrlAdisByRRtryDurnTim)
+      if (SftyActvDchaCtrlByRRtryDurnCnt > sftyActvDchaCtrlAdisByRRtryDurnTim)
       {
-         SftyActvDchaCtrlReqAdisByRCmdUpdEna = ENABLED;
+         SftyActvDchaCtrlReqAdisByRCmdUpdEna = SFTY_ACTIV_DCHA_ENABLED;
       }
 \t  else
 \t  {
@@ -649,7 +649,7 @@ LOCAL_INLINE void SftyActvDchaCtrl_UpdAdisReqCmd(void)
    /* Update the Request Command */
    if ((SftyActvDchaCtrlActvDchaReq == ACTV_DCHA_ACTVE)
        &&
-   \t   (SftyActvDchaCtrlReqAdisByRCmdUpdEna == ENABLED))
+   \t   (SftyActvDchaCtrlReqAdisByRCmdUpdEna == SFTY_ACTIV_DCHA_ENABLED))
    {
       if (SftyActvDhaCtrlAdisOperSts == ADIS_OPER_STS_FINISHED)
       {
@@ -672,7 +672,7 @@ LOCAL_INLINE void SftyActvDchaCtrl_UpdAdisReqCmd(void)
 
 \t  /* Reset them for Interval Time Checking */
 \t  SftyActvDchaCtrlByRRtryDurnCnt      = 0UL;
-\t  SftyActvDchaCtrlReqAdisByRCmdUpdEna = DISABLED;
+\t  SftyActvDchaCtrlReqAdisByRCmdUpdEna = SFTY_ACTIV_DCHA_DISABLED;
    }
    else
    {
@@ -695,18 +695,18 @@ LOCAL_INLINE void SftyActvDchaCtrl_UpdAdisReqCmd(void)
 LOCAL_INLINE void SftyActvDchaCtrl_MonrAdisByREfc(void)
 {
    /* ******** Variables declaration *********** */
-   float32 SftyActvDchaCtrlDeltaHvDcUVal   = 0.0f;
-   uint32 AdisEffeChkTotalFailTimesAdisByRTim = 0UL;
-   uint8 AdisMonrDvDtEn = DISABLED;
-   static ErrDeb_MonrStsType AdisEfcErrMonrStInRow = ERR_DEB_MONR_STS_INACTIVE;
-   static ErrDeb_MonrStsType AdisEfcErrMonrStTotal = ERR_DEB_MONR_STS_INACTIVE;
+   float32 sftyActvDchaCtrlDeltaHvDcUVal;
+   uint32 adisEffeChkTotalFailTimesAdisByRTim ;
+   uint8 adisMonrDvDtEn = SFTY_ACTIV_DCHA_DISABLED;
+   static ErrDeb_MonrStsType adisEfcErrMonrStInRow = ERR_DEB_MONR_STS_INACTIVE;
+   static ErrDeb_MonrStsType adisEfcErrMonrStTotal = ERR_DEB_MONR_STS_INACTIVE;
    
    /* ************* Source code **************** */
 
    /* Checking the delay time for monitoring Dv/Dt */
    if (SftyActvDhaCtrlDvDtChkDelayTimAdisByRCnt >= SftyActvDchaPrmData.DvDtChkDelayTimAdisByRThd)
    {
-      AdisMonrDvDtEn = ENABLED;
+      adisMonrDvDtEn = SFTY_ACTIV_DCHA_ENABLED;
    }
    else
    {
@@ -714,7 +714,7 @@ LOCAL_INLINE void SftyActvDchaCtrl_MonrAdisByREfc(void)
    }
 
    /* Checking Dv/Dt */
-   if ((AdisMonrDvDtEn == ENABLED)
+   if ((adisMonrDvDtEn == SFTY_ACTIV_DCHA_ENABLED)
    \t   &&
    \t   (SftyActvDchaCtrlHvDcUVal >= SftyActvDchaPrmData.HvDcVoltThd))
    {
@@ -723,12 +723,12 @@ LOCAL_INLINE void SftyActvDchaCtrl_MonrAdisByREfc(void)
          SftyActvDchaCtrlDeltaTimeResistorCnt = 0U;   /* Clear delta time countor */
 
 \t\t /* Calculate Dv */
-\t\t SftyActvDchaCtrlDeltaHvDcUVal = MLIB_F32AbsF32(SftyActvDchaCtrlHvDcUValPre - SftyActvDchaCtrlHvDcUVal);
+\t\t sftyActvDchaCtrlDeltaHvDcUVal = MLIB_F32AbsF32(SftyActvDchaCtrlHvDcUValPre - SftyActvDchaCtrlHvDcUVal);
 \t\t SftyActvDchaCtrlHvDcUValPre = SftyActvDchaCtrlHvDcUVal;
 
          if ((SftyActvDchaCtrlHvDcUValPre > SftyActvDchaCtrlHvDcUVal)   /* The Trend has to be down */
 \t\t \t &&
-\t\t     (SftyActvDchaCtrlDeltaHvDcUVal >= SftyActvDchaPrmData.AdisByREnaDvThd))
+\t\t     (sftyActvDchaCtrlDeltaHvDcUVal >= SftyActvDchaPrmData.AdisByREnaDvThd))
          {
             SftyActvDchaCtrlEffeChkFailTimeAdisByRInRowCnt = 0U;
          }
@@ -756,26 +756,26 @@ LOCAL_INLINE void SftyActvDchaCtrl_MonrAdisByREfc(void)
 \t\t /* Checking Continous Failure */
          if (SftyActvDchaCtrlEffeChkFailTimeAdisByRInRowCnt >= SftyActvDchaPrmData.EffeChkFailTimeByRInRowThd)
          {
-            AdisEfcErrMonrStInRow = ERR_DEB_MONR_STS_FAILED;
+            adisEfcErrMonrStInRow = ERR_DEB_MONR_STS_FAILED;
          }
 \t\t else
 \t\t {
-\t\t    AdisEfcErrMonrStInRow = ERR_DEB_MONR_STS_PASSED;
+\t\t    adisEfcErrMonrStInRow = ERR_DEB_MONR_STS_PASSED;
 \t\t }
 
          /* Checking Total Failure */
 \t\t SftyActvDchaCtrlEffeChkTotalFailTimesAdisByRTimCnt++;
-\t\t AdisEffeChkTotalFailTimesAdisByRTim = MLIB_U32F32((SftyActvDchaPrmData.EffeChkTotalFailTimesByRTimThd) * ((float32)CNT_1S_TO_10MS));
+\t\t adisEffeChkTotalFailTimesAdisByRTim = MLIB_U32F32((SftyActvDchaPrmData.EffeChkTotalFailTimesByRTimThd) * ((float32)CNT_1S_TO_10MS));
 
-\t\t if ((SftyActvDchaCtrlEffeChkTotalFailTimesAdisByRTimCnt < AdisEffeChkTotalFailTimesAdisByRTim)         /* < 1.5s */
+\t\t if ((SftyActvDchaCtrlEffeChkTotalFailTimesAdisByRTimCnt < adisEffeChkTotalFailTimesAdisByRTim)         /* < 1.5s */
 \t\t \t &&
 \t\t \t (SftyActvDchaCtrlEffeChkFailTimesAdisByRTotCnt >= SftyActvDchaPrmData.EffeChkFailTimeByRTotThd))   /* >= 5 Times */
 \t\t {
-\t\t    AdisEfcErrMonrStTotal = ERR_DEB_MONR_STS_FAILED;
+\t\t    adisEfcErrMonrStTotal = ERR_DEB_MONR_STS_FAILED;
 \t\t }
 \t\t else
 \t\t {
-\t\t    AdisEfcErrMonrStTotal = ERR_DEB_MONR_STS_PASSED;
+\t\t    adisEfcErrMonrStTotal = ERR_DEB_MONR_STS_PASSED;
 \t\t }\t\t 
       }
 \t  else
@@ -791,20 +791,20 @@ LOCAL_INLINE void SftyActvDchaCtrl_MonrAdisByREfc(void)
 \t  SftyActvDchaCtrlEffeChkTotalFailTimesAdisByRTimCnt = 0UL;
 \t  SftyActvDchaCtrlHvDcUValPre                        = SftyActvDchaCtrlHvDcUVal;
 
-\t  AdisEfcErrMonrStInRow                              = ERR_DEB_MONR_STS_INACTIVE;
-\t  AdisEfcErrMonrStTotal                              = ERR_DEB_MONR_STS_INACTIVE;
+\t  adisEfcErrMonrStInRow                              = ERR_DEB_MONR_STS_INACTIVE;
+\t  adisEfcErrMonrStTotal                              = ERR_DEB_MONR_STS_INACTIVE;
    }
 
    /* Final Check the Effectivity of Active Discharge by Resistor */
-   if ((AdisEfcErrMonrStInRow == ERR_DEB_MONR_STS_FAILED)
+   if ((adisEfcErrMonrStInRow == ERR_DEB_MONR_STS_FAILED)
        ||
-       (AdisEfcErrMonrStTotal == ERR_DEB_MONR_STS_FAILED))
+       (adisEfcErrMonrStTotal == ERR_DEB_MONR_STS_FAILED))
    {
       SftyActvDchaCtrlEfcErrMonrStIntel = ERR_DEB_MONR_STS_FAILED;
    }
-   else if ((AdisEfcErrMonrStInRow == ERR_DEB_MONR_STS_PASSED)
+   else if ((adisEfcErrMonrStInRow == ERR_DEB_MONR_STS_PASSED)
             &&
-            (AdisEfcErrMonrStTotal == ERR_DEB_MONR_STS_PASSED))
+            (adisEfcErrMonrStTotal == ERR_DEB_MONR_STS_PASSED))
    {
       SftyActvDchaCtrlEfcErrMonrStIntel = ERR_DEB_MONR_STS_PASSED;
    }
@@ -830,15 +830,15 @@ LOCAL_INLINE void SftyActvDchaCtrl_MonrAdisByRSuccess(void)
 {
 
    /* ******** Variables declaration *********** */
-   uint32 SftyActvDchaCtrlAdisByRTime = 0UL;
+   uint32 sftyActvDchaCtrlAdisByRTime;
    
    /* ************* Source code **************** */
 
    if (SftyActvDchaCtrlHvDcUVal < (SftyActvDchaPrmData.HvDcVoltThd - SftyActvDchaPrmData.HvDcVoltHys))
    {
-      SftyActvDchaCtrlAdisByRTime = ((uint32)SftyActvDchaPrmData.AdisByRTimeThd) * ((uint32)CNT_1S_TO_1MS);
+      sftyActvDchaCtrlAdisByRTime = ((uint32)SftyActvDchaPrmData.AdisByRTimeThd) * ((uint32)CNT_1S_TO_1MS);
 \t\t 
-      if (SftyActvDchaCtrlAdisByRTimeCnt < SftyActvDchaCtrlAdisByRTime)
+      if (SftyActvDchaCtrlAdisByRTimeCnt < sftyActvDchaCtrlAdisByRTime)
       {
          SftyActvChaCtrlAdisSuccessful = ERR_DEB_MONR_STS_PASSED;
       }
@@ -911,19 +911,19 @@ LOCAL_INLINE void SftyActvDchaCtrl_MonrAdisByRExit(void)
 LOCAL_INLINE void SftyActvDchaCtrl_MonrAdisSts(void)
 {
    /* ******** Variables declaration *********** */
-   float32 SftyActvDchaCtrlAdisFaultThd = 0.0f;
-   uint32 SftyActvDchaCtrlAdisFaultTimeThd = 0UL;
+   float32 sftyActvDchaCtrlAdisFaultThd;
+   uint32 sftyActvDchaCtrlAdisFaultTimeThd;
    
    /* ************* Source code **************** */
 
    if (SftyActvDhaCtrlAdisOperSts == ADIS_OPER_STS_RUNNING)
    {
-      SftyActvDchaCtrlAdisFaultTimeThd = ((uint32)SftyActvDchaPrmData.AdisFaultTimeThd) * ((uint32)CNT_1S_TO_1MS);
+      sftyActvDchaCtrlAdisFaultTimeThd = ((uint32)SftyActvDchaPrmData.AdisFaultTimeThd) * ((uint32)CNT_1S_TO_1MS);
 \t  
-\t  if (SftyActvDchaCtrlAdisFaultTimeCnt > SftyActvDchaCtrlAdisFaultTimeThd)   /* > 2s */  
+\t  if (SftyActvDchaCtrlAdisFaultTimeCnt > sftyActvDchaCtrlAdisFaultTimeThd)   /* > 2s */  
       {
-\t\t SftyActvDchaCtrlAdisFaultThd = SftyActvDchaPrmData.HvDcVoltThd - SftyActvDchaPrmData.HvDcVoltTole;   /* > (60V - 1.3V) */
-\t\t if (SftyActvDchaCtrlHvDcUVal > SftyActvDchaCtrlAdisFaultThd)
+\t\t sftyActvDchaCtrlAdisFaultThd = SftyActvDchaPrmData.HvDcVoltThd - SftyActvDchaPrmData.HvDcVoltTole;   /* > (60V - 1.3V) */
+\t\t if (SftyActvDchaCtrlHvDcUVal > sftyActvDchaCtrlAdisFaultThd)
          {
             SftyActvDchaCtrlFltErrMonrStIntel = ERR_DEB_MONR_STS_FAILED;
          }
@@ -1118,7 +1118,7 @@ FUNC(void, SFTYACTVDCHACTRL) SftyActvDchaCtrl_Init(void)
    SftyActvDchaCtrlActvDchaReqIntel     = ACTV_DCHA_DEACTVE;
    SftyActvDchaCtrlActvDchaReqExtel     = ACTV_DCHA_DEACTVE;
    SftyActvDchaCtrlActvDchaReq          = ACTV_DCHA_DEACTVE;   
-   SftyActvDchaCtrlReqAdisByRCmdUpdEna  = ENABLED;   /* For the first run, no delay time */
+   SftyActvDchaCtrlReqAdisByRCmdUpdEna  = SFTY_ACTIV_DCHA_ENABLED;   /* For the first run, no delay time */
    SftyActvDhaCtrlAdisOperSts           = ADIS_OPER_STS_INACTIVE;
    SftyActvChaCtrlAdisSuccessful        = ERR_DEB_MONR_STS_INACTIVE;
    SftyActvDchaCtrlEfcErrMonrStIntel    = ERR_DEB_MONR_STS_INACTIVE;
'
