b'commit 242fb516225691822e5716d36907fb1deb262aa4
Author: Mohab MOSTAFA <mohab.mostafa@valeo.com>
Date:   Mon Nov 15 11:10:12 2021 +0200

    $100kW-45219$ updates for DetectInterlock
    
    Change-Id: I4c4c2ffe869b13360ca69c2ae2a6290b458eaa6f

diff --git a/src/fw_cu/Components/Cmn/SWIT/SWIT_SFTY/include/SWIT_Sfty.h b/src/fw_cu/Components/Cmn/SWIT/SWIT_SFTY/include/SWIT_Sfty.h
index f43ee69a1..ffb0fbfe0 100644
--- a/src/fw_cu/Components/Cmn/SWIT/SWIT_SFTY/include/SWIT_Sfty.h
+++ b/src/fw_cu/Components/Cmn/SWIT/SWIT_SFTY/include/SWIT_Sfty.h
@@ -2825,6 +2825,8 @@ extern void  SWIT_FPU_TRAP_Core1_BgnHook(void);
 /*Fault injection test for Detect_Interlock_Event*/
 /*SftyHvInterlockTiErrMonrSt*/
 
+extern void SWIT_SftyHvInterlock_GetTiStamp_EndHook(uint32* SWIT_lst_Tistamp);
+extern void SWIT_SftyDma_UpdateRawInterlockData_EndHook(void);
 
 
 
@@ -2835,8 +2837,6 @@ extern void  SWIT_FPU_TRAP_Core1_BgnHook(void);
 #include "SWIT_MemMap.h"
 /*Fault injection test for Detect_Interlock_Event*/
 /*SftyHvInterlockTiErrMonrSt*/
-extern void SWIT_SftyHvInterlock_GetTiStamp_EndHook(uint32* SWIT_lst_Tistamp);
-extern void SWIT_SftyDma_UpdateRawInterlockData_EndHook(void);
 
 #define SWIT_SFTY_AREA_2_STOP_SEC_CODE_FAST
 #include "SWIT_MemMap.h"
diff --git a/src/fw_cu/Components/Cmn/SWIT/SWIT_SFTY/src/SWIT_SFTY_Area2.c b/src/fw_cu/Components/Cmn/SWIT/SWIT_SFTY/src/SWIT_SFTY_Area2.c
index 9e4378e3f..ece986c46 100644
--- a/src/fw_cu/Components/Cmn/SWIT/SWIT_SFTY/src/SWIT_SFTY_Area2.c
+++ b/src/fw_cu/Components/Cmn/SWIT/SWIT_SFTY/src/SWIT_SFTY_Area2.c
@@ -257,17 +257,6 @@ if( (SWIT_FPU_Enable == INVALID_OPERATION) || (SWIT_First_HookEnableKey == SWIT_
 /*Fault injection test for Detect_Interlock_Event*/
 /*SftyHvInterlockTiErrMonrSt*/
 /*save the valie of the last Time stamp here because it is static var*/
-
-
-#define SWIT_SFTY_AREA_2_STOP_SEC_CODE_SLOW
-#include "SWIT_MemMap.h"
-
-
-#define SWIT_SFTY_AREA_2_START_SEC_CODE_FAST
-#include "SWIT_MemMap.h"
-/*Fault injection test for Detect_Interlock_Event*/
-/*SftyHvInterlockTiErrMonrSt*/
-
 void SWIT_SftyDma_UpdateRawInterlockData_EndHook(void)
 {
    SWIT_Sfty_Set(&SftyDmaVadcInterlock,SftyDmaVadcInterlock_Output_KEY,SWIT_UINT16);
@@ -290,6 +279,17 @@ if(SWIT_Interface_Input_key==SftyHvInterlockVadcLstTiStamp_Input_KEY)
 }
 }
 
+
+#define SWIT_SFTY_AREA_2_STOP_SEC_CODE_SLOW
+#include "SWIT_MemMap.h"
+
+
+#define SWIT_SFTY_AREA_2_START_SEC_CODE_FAST
+#include "SWIT_MemMap.h"
+/*Fault injection test for Detect_Interlock_Event*/
+/*SftyHvInterlockTiErrMonrSt*/
+
+
 #define SWIT_SFTY_AREA_2_STOP_SEC_CODE_FAST
 #include "SWIT_MemMap.h"
 /***************End of ASIL B Functions***********************/
diff --git a/src/fw_cu/Components/Safety/Sfty_Cmn/SftyDma/src/SftyDma.c b/src/fw_cu/Components/Safety/Sfty_Cmn/SftyDma/src/SftyDma.c
index 204ba1085..0baf88722 100644
--- a/src/fw_cu/Components/Safety/Sfty_Cmn/SftyDma/src/SftyDma.c
+++ b/src/fw_cu/Components/Safety/Sfty_Cmn/SftyDma/src/SftyDma.c
@@ -478,7 +478,7 @@ FUNC(void, SFTYDMA_CODE) SftyDma_UpdateRawInterlockData(void)
 
 
 
-#if  defined(SWIT_IT_Active)
+#if  defined(SWIT_IT_Active)||defined(SWIT_Active)
    SWIT_SftyDma_UpdateRawInterlockData_EndHook();
 #endif
 
diff --git a/src/fw_cu/Components/Safety/Sfty_Inv/SftyAcEvln/src/SftyAcEvln.c b/src/fw_cu/Components/Safety/Sfty_Inv/SftyAcEvln/src/SftyAcEvln.c
index 5fcc233a4..f75f34adc 100644
--- a/src/fw_cu/Components/Safety/Sfty_Inv/SftyAcEvln/src/SftyAcEvln.c
+++ b/src/fw_cu/Components/Safety/Sfty_Inv/SftyAcEvln/src/SftyAcEvln.c
@@ -620,7 +620,6 @@ FUNC(void, SFTY_AC_EVLN_CODE) SftyAcEvln_InitArea2(void)
 /******************************************************************/
 FUNC(void, SFTY_AC_EVLN_CODE) SftyAcEvln_MainFunctionAreaCmn(void)
 {
-    uint8 idxPu = 0u;
 #ifdef SWIT_FC_Active
    if((SWIT_SftyAcEvln_EN_KEY==SWIT_First_HookEnableKey))
    SWIT_SftyAcEvln_MainFunctionAreaCmn_BgnHook();
@@ -631,6 +630,8 @@ FUNC(void, SFTY_AC_EVLN_CODE) SftyAcEvln_MainFunctionAreaCmn(void)
       SWIT_SftyAcEvln_MainFunctionAreaCmn_BgnHook();
    }
 #endif
+    uint8 idxPu = 0u;
+
     /* Clear error status */
 \tSftyAcEvlnPlausErrMonrSt = ERR_DEB_MONR_STS_INACTIVE; 
 \t
'
